<!-- Search Section with explicit sizing -->
<div class="bg-white rounded-lg shadow-md p-6 mb-8">
    <form method="get" action="/events/" id="event-filter-form" class="space-y-4">
        <!-- Search Row 1: Main search input -->
        <div class="w-full">
            <input type="text" name="search" value="" 
                   placeholder="Search events, venues, or locations..." 
                   class="w-full px-4 py-3 text-base border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        
        <!-- Search Row 2: Controls -->
        <div class="flex flex-wrap gap-3">
            <!-- Category dropdown -->
            <select name="category" class="px-3 py-2.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                <option value=""> Categories</option>
                <option value="arts-culture">Arts & Culture</option>
                <option value="drinks">Drinks</option>
                <option value="family-kids">Family & Kids</option>
                <option value="food">Food</option>
                <option value="music-concerts">Music & Concerts</option>
            </select>
            
            <!-- Search button -->
            <button type="submit" class="px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-medium">
                <i class="fas fa-search mr-1.5"></i>Search
                <span id="search-spinner" class="htmx-indicator ml-2">
                    <i class="fas fa-spinner fa-spin"></i>
                </span>
            </button>
            
            <!-- Toggle Advanced Search -->
            <button type="button" 
                    onclick="toggleAdvancedSearch()"
                    class="px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition text-sm font-medium flex items-center">
                <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                </svg>
                <span id="advanced-toggle-text">Show Filters</span>
            </button>
        </div>
        
        <!-- Quick Filters -->
        <div class="border-t pt-4">
            <label class="block text-sm font-medium text-gray-700 mb-3">Quick Filters:</label>
            <div class="flex flex-wrap gap-2.5">
                <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="filter" value="free" 
                           class="mr-2 rounded text-blue-600 focus:ring-blue-500"
                           onchange="document.getElementById('event-filter-form').submit()">
                    <span class="px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                        <i class="fas fa-tag mr-1 text-xs"></i>Free Events
                    </span>
                </label>
                
                <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="filter" value="weekend" 
                           class="mr-2 rounded text-blue-600 focus:ring-blue-500"
                           onchange="document.getElementById('event-filter-form').submit()">
                    <span class="px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                        <i class="far fa-calendar mr-1 text-xs"></i>Weekend
                    </span>
                </label>
                
                <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="filter" value="family-friendly" 
                           class="mr-2 rounded text-blue-600 focus:ring-blue-500"
                           onchange="document.getElementById('event-filter-form').submit()">
                    <span class="px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                        <i class="fas fa-users mr-1 text-xs"></i>Family Friendly
                    </span>
                </label>
                
                <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="filter" value="pet-friendly" 
                           class="mr-2 rounded text-blue-600 focus:ring-blue-500"
                           onchange="document.getElementById('event-filter-form').submit()">
                    <span class="px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                        <i class="fas fa-paw mr-1 text-xs"></i>Pet Friendly
                    </span>
                </label>
                
                <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="filter" value="offers" 
                           class="mr-2 rounded text-blue-600 focus:ring-blue-500"
                           onchange="document.getElementById('event-filter-form').submit()">
                    <span class="px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition">
                        <i class="fas fa-percent mr-1 text-xs"></i>Special Offers
                    </span>
                </label>
            </div>
        </div>
        
        <!-- Advanced Filters (Hidden by default) -->
        <div id="advanced-filters" class="hidden space-y-4 pt-4 border-t">
            <input type="hidden" name="show_advanced" id="show_advanced" value="false">
            
            <!-- Date and Price Filters -->
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Date From -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">From Date</label>
                    <input type="date" name="date_from" 
                           value=""
                           class="w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <!-- Date To -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">To Date</label>
                    <input type="date" name="date_to" 
                           value=""
                           class="w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <!-- Min Price -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Min Price (£)</label>
                    <input type="number" name="price_min" 
                           value=""
                           min="0" step="0.01"
                           class="w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <!-- Max Price -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Max Price (£)</label>
                    <input type="number" name="price_max" 
                           value=""
                           min="0" step="0.01"
                           class="w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
            
            <!-- Sort Options -->
            <div class="flex items-center gap-3">
                <label class="text-sm font-medium text-gray-700 whitespace-nowrap">Sort by:</label>
                <select name="sort" class="px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="-date" selected>Date (Newest)</option>
                    <option value="date">Date (Oldest)</option>
                    <option value="price">Price (Low to High)</option>
                    <option value="-price">Price (High to Low)</option>
                    <option value="title">Title (A-Z)</option>
                </select>
            </div>
            
            <!-- Clear Filters -->
            <div class="flex justify-end">
                <a href="/events/" 
                   class="text-sm text-gray-600 hover:text-gray-800 underline">
                    Clear all filters
                </a>
            </div>
        </div>
    </form>
</div>

<script>
function toggleAdvancedSearch() {
    const advancedFilters = document.getElementById('advanced-filters');
    const toggleText = document.getElementById('advanced-toggle-text');
    const showAdvancedInput = document.getElementById('show_advanced');
    
    if (advancedFilters.classList.contains('hidden')) {
        advancedFilters.classList.remove('hidden');
        toggleText.textContent = 'Hide Filters';
        showAdvancedInput.value = 'true';
    } else {
        advancedFilters.classList.add('hidden');
        toggleText.textContent = 'Show Filters';
        showAdvancedInput.value = 'false';
    }
}
</script>